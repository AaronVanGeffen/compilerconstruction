\documentclass[a4paper,draft]{report}

\usepackage[utf8]{inputenc}
\usepackage[british]{babel}
\usepackage{xcolor}
\definecolor{linkcolor}{rgb}{0.65,0,0}
\definecolor{citecolor}{rgb}{0,0.65,0}
\definecolor{urlcolor}{rgb}{0,0,0.65}
\usepackage[
    colorlinks=true,
    linkcolor=linkcolor,
    urlcolor=urlcolor,
    citecolor=citecolor
]{hyperref}
\usepackage{microtype}
\usepackage{libertine}
\usepackage{todonotes}

\author{Aaron van Geffen \and Thom Wiggers}
\title{Compiler Construction report}

\begin{document}
\maketitle

\chapter*{Introduction}

\todo[inline]{Dibs Aaron}
\todo[inline]{Why Haskell}

In each chapter, we will reflect how we would do things differently next time.

\chapter{Parser}
\todo[inline]{Dibs Aaron}

\section{Transforming the grammar}
\todo[inline]{left recursion: function argument, expressions, fields\\ refer to grammar in appendix}

\section{Parser Combinators}
\todo[inline]{parser combinators, how do they work?, megaparsec}

\section{Pretty Printing}
\todo[inline]{printer combinators}

\section{Reflection}
\todo[inline]{combinators are awesome. AST not fancy enough: records for extensibility, include locations for error messages}


\chapter{Static Analysis}
\todo[inline]{Dibs Thom}
\todo[inline]{ergens scoping}

\section{Type Checking}
\todo[inline]{How checked types}

\section{Type Inference}
\todo[inline]{Credit that tutorial, explain algorithm}

\section{Type Rules}

\section{Reflection}
\todo[inline]{Haskell is great. No error when specified type is more general than expression, time wasted on checking, poor error messages}


\chapter{Code Generation}
\todo[inline]{Dibs Aaron}
\section{Intermediate Representation}
\todo[inline]{Idea: simplify to something that looks more like asm. Unrolls stuff, less fancy constructs, explain what remains.}

\section{Simple Stack Machine}
\todo[inline]{Explain how registers aren't needed, how stack works, globals on stack as pseudo-heap, lists and tuples on heap, calling convention}

\section{Reflection}
\todo[inline]{IR too simple: loss of context, temporaries hard to distinguish (LDC, LDL) and thus aren't thrown away as they are treated like regular vars.}


\chapter{AArch64}

\todo[inline]{Dibs Thom}
\section{Architecture Outline}
\todo[inline]{Cortex A53, ODROID-C2, registers}

\section{Calling Convention}
\todo[inline]{Link register instead of ptr on stack, C calling convention, callee-saved/caller-saved}

\section{Register Allocation}
\todo[inline]{register dependencies, register allocation, why not graph colouring: single static assignment is hard but needs to be done first, then graph colouring }

\section{Remaining Work}

\section{Reflection}

\appendix

\chapter{SPL Grammar}\label{ch:grammar}
\todo[inline]{grammar}

\todo[inline]{Dibs Aaron}

\listoftodos{}

\end{document}

% vim: set ts=4 sw=4 tw=0 wrap et :
